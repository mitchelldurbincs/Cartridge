| From → To                                      | Protocol         | Payload (contract)                                       | Purpose                                      | Stored where (Local / docker-compose)                                                    | Stored where (Prod on GCP)                                                                                                                                                                             |
| ---------------------------------------------- | ---------------- | -------------------------------------------------------- | -------------------------------------------- | ---------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Actor (Rust)** → **Replay (Go)**             | gRPC streaming   | `Experience` (protobuf)                                  | Push transitions (obs, action, reward, done) | **Replay RAM** (in-proc ring buffers). Optional: **Redis Streams** container             | **Replay RAM** (default) **or** **Redis Streams on Memorystore** (optional). _Note: Redis = cache/queue, not system of record._                                                                        |
| **Learner (PyTorch)** ↔ **Replay**             | gRPC stream pull | `SampleRequest` / `SampleBatch`                          | Sample mini-batches for SGD                  | N/A (streamed)                                                                           | N/A (streamed)                                                                                                                                                                                         |
| **Learner** → **Object Store**                 | S3/GCS API       | Checkpoint shards (`.safetensors.zst`) + `MANIFEST.json` | Elastic checkpoints                          | **MinIO** bucket, e.g. `s3://rl/runs/<run_id>/ckpt/<step>/`                              | **GCS** bucket, e.g. `gs://rl-platform/runs/<run_id>/ckpt/<step>/`                                                                                                                                     |
| **Learner / Aggregator** → **Parquet dataset** | S3/GCS API       | **Steps** / **Episodes** (Parquet)                       | Offline analysis, dashboards                 | **MinIO**: `s3://rl/parquet/{steps                                                       | episodes}/…`                                                                                                                                                                                           |
| **Weights Publisher** → **Actors**             | gRPC simple      | `WeightsBlob {version, payload}`                         | Distribute current/candidate weights         | Blobs in **MinIO** under `runs/<run_id>/weights/{current                                 | candidate}/…`; **Redis** (container) as **version KV** (`weights:<exp_id> → {version, uri}`)                                                                                                           |
| **Orchestrator** → **Postgres**                | SQL              | Run/Experiment/Artifact rows                             | Lineage, config, status                      | **Postgres** container (named volume)                                                    | **Cloud SQL for PostgreSQL** (private IP to GKE)                                                                                                                                                       |
| **Aggregator** → **Postgres**                  | SQL              | Episode summaries, win rate                              | Fast UI queries                              | **Postgres** container                                                                   | **Cloud SQL for PostgreSQL**                                                                                                                                                                           |
| **All services** → **Prometheus/Loki/Tempo**   | `/metrics`, OTLP | Metrics / Logs / Traces                                  | Observability                                | **Prometheus** (container TSDB), **Loki** & **Tempo/Jaeger** writing to local disk/MinIO | **Prometheus** on GKE (optionally Thanos for long retention, GCS backend), **Loki** with **GCS backend**, **Tempo/Jaeger** with **GCS backend** (or use Cloud Monitoring/Logging if you prefer native) |
